0. tcp/ip 协议族分层

```text
---------------
|             |
| Application |   Telnet,FTp,SMTP etc
|             |
---------------
|             |
| Transport   |   TCP，UDP
|             |
---------------
|             |
|  Internet   |   IP,ICMP,IGMP
|             |
---------------
|             |
| Data Link   |   设备驱动程序及接口卡
|             |
---------------
```

1. 协议调用图示

```text

------------------------------------------------------------
|              |              |             |              |
|  Application |  Application | Application |  Application | 
|              |              |             |              |
---/|\------------------------------------------------------
    |               /|\             /|\
    |\               |               |
    | \              |               |
    |  \             |               |
    |   \            |               |
    |    \      ----\|/-------------\|/
    |     \     |         |           |
    |      \    | tcp     |  udp      |
    |       \   |         |           |
    |        \  ------/|\------/|\-----
    |         \        |        |
    |          \       |        |
    |           \      |        |
    |            \     |        |
---\|/-----------\|/--\|/------\|/-------------------------
|        |       |                  |             |       |
|  ICMP  |<----->|        IP        | <---------> |  IGMP |
|        |       |                  |             |       |
------------------------/|\--------------------------------
                         |      
                         |        
                         |        
                         |        
------------------------\|/--------------------------------
|        |       |                  |             |       |
|  ARP   |<----->|Hardware Interface| <---------> |  RARP |
|        |       |                  |             |       |
-----------------------------------------------------------



```

2. ip 地址

分为5类

```text
 
                 7位                  24位
A类：| 0 |     网络号      |         主机号          | 

                    14位                 16位
B类：| 1 | 0 |     网络号          |     主机号      | 

                      21位                     8位
C类：| 1 | 1 | 0 |   网络号                 | 主机号 |

                           28位
D类：| 1 | 1 | 1 | 0 |     多播组号                  |

                                  27位
E类：| 1 | 1 | 1 | 1 | 0 |       留待后用            |

```

记忆：无公共前缀编码

3. 封装

- tcp/ip 头部分别为 20 字节
- udp 头部 8 字节
- 以太网首部 14 字节 + 尾部 4 字节


4. 分用 （Demultiplexing）

tcp udp 协议使用端口号来区分应用程序，长度位 16 bit；ip 中有协议域字段，8 bit，来区分上层协议（1:ICMP，2:IGMP，6:TCP，17:UDP）；以太网帧首部有 16bit 的类型字段标识网络层协议（0800:IP，0806：ARP，8035: RARP）

5.

- IP 网络层提供点到点服务，TCP与UDP运输层服务则提供端到端服务
- Unix 系统保留端口号 1～1023，只有超级用户才可以使用
- 以太网数据帧的物理特性是其数据长度必须在 46～1500 字节之间（以太网首部与尾部不计算在内）
